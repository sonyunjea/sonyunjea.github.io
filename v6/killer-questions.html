<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>킬러 문항 정복 - 사회·문화 공략집</title>
    <!-- Tailwind CSS CDN 스크립트 -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Chart.js CDN 스크립트 -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Google Fonts (Inter) -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
    <!-- 사용자 정의 스타일 -->
    <style>
        html { scroll-behavior: smooth; }
        body { font-family: 'Inter', 'sans-serif'; }
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .fade-in-up { animation: fadeInUp 0.6s ease-out forwards; }
    </style>
</head>
<body class="bg-gray-50 text-gray-800">

<!-- Header Section -->
<header class="bg-white/90 backdrop-blur-lg sticky top-0 z-50 shadow-md border-b border-gray-200">
    <nav class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex justify-between items-center py-4">
            <a href="./index.html" class="flex items-center space-x-2">
                <span class="text-2xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-blue-600 to-emerald-500">
                    ✨ 사회·문화 공략집
                </span>
            </a>
            <div class="hidden md:flex items-center space-x-8 text-base font-medium">
                <a href="./concepts.html" class="text-gray-600 hover:text-blue-600 transition duration-300">심화 개념</a>
                <a href="./killer-questions.html" class="text-emerald-600 font-semibold border-b-2 border-emerald-600 pb-1">킬러 문항</a>
                <a href="./theories.html" class="text-gray-600 hover:text-blue-600 transition duration-300">이론 적용</a>
            </div>
        </div>
    </nav>
</header>

<!-- Main Content -->
<main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16">

    <section id="killer-questions" class="fade-in-up" style="opacity:0;">
        <!-- Page Title -->
        <div class="text-center mb-12">
            <h2 class="text-4xl font-extrabold text-gray-900 tracking-tight">킬러 문항 정복</h2>
            <p class="mt-4 text-lg text-gray-600">최고난도 도표 문항을 데이터 시각화와 함께 완벽 분석합니다.</p>
        </div>

        <!-- 계층 이동 분석 -->
        <div class="bg-white p-8 sm:p-10 rounded-2xl shadow-xl mb-12">
            <h3 class="text-3xl font-bold mb-4 text-center text-gray-800">📊 유형 1: 세대 간 계층 이동 분석</h3>
            <p class="text-center text-gray-600 mb-10 max-w-2xl mx-auto">버튼을 클릭하여 특정 유형의 계층 이동 데이터를 시각적으로 확인하고, 그 의미를 분석하는 훈련을 합니다.</p>
            <div class="grid lg:grid-cols-2 gap-8 items-center">
                <div class="h-80 md:h-96">
                    <canvas id="mobilityChart"></canvas>
                </div>
                <div>
                    <div class="flex flex-wrap gap-3 mb-6">
                        <button onclick="updateMobilityChart('all')" class="px-4 py-2 text-sm font-semibold rounded-full bg-slate-200 hover:bg-slate-300 transition">전체</button>
                        <button onclick="updateMobilityChart('inheritance')" class="px-4 py-2 text-sm font-semibold rounded-full bg-slate-200 hover:bg-slate-300 transition">계층 대물림</button>
                        <button onclick="updateMobilityChart('upward')" class="px-4 py-2 text-sm font-semibold rounded-full bg-slate-200 hover:bg-slate-300 transition">상승 이동</button>
                        <button onclick="updateMobilityChart('downward')" class="px-4 py-2 text-sm font-semibold rounded-full bg-slate-200 hover:bg-slate-300 transition">하강 이동</button>
                    </div>
                    <div id="mobility-explanation" class="bg-slate-50 p-6 rounded-lg border border-slate-200 min-h-[120px]">
                        <!-- Explanation will be inserted here -->
                    </div>
                </div>
            </div>
        </div>

        <!-- 인구 구조 분석 -->
        <div class="bg-white p-8 sm:p-10 rounded-2xl shadow-xl">
            <h3 class="text-3xl font-bold mb-4 text-center text-gray-800">📈 유형 2: 인구 구조와 부양비 분석</h3>
            <p class="text-center text-gray-600 mb-10 max-w-2xl mx-auto">연도별 인구 구조 변화를 확인하고, 그에 따른 노령화 지수와 부양비의 변화를 직접 계산하며 추이를 분석합니다.</p>
             <div class="grid lg:grid-cols-2 gap-8 items-center">
                <div class="h-80 md:h-96 flex justify-center">
                    <div class="relative w-full max-w-xs">
                        <canvas id="populationChart"></canvas>
                    </div>
                </div>
                <div>
                    <div class="flex flex-wrap gap-3 mb-6">
                        <button onclick="updatePopulationData(0)" class="px-4 py-2 font-semibold rounded-full transition">1990년</button>
                        <button onclick="updatePopulationData(1)" class="px-4 py-2 font-semibold rounded-full transition">2020년</button>
                        <button onclick="updatePopulationData(2)" class="px-4 py-2 font-semibold rounded-full transition">2050년</button>
                    </div>
                    <div id="population-explanation" class="bg-slate-50 p-6 rounded-lg border border-slate-200">
                        <h4 class="font-semibold text-lg mb-3"></h4>
                        <ul class="space-y-3 text-slate-700">
                            <li>
                                <strong>유소년 부양비:</strong> 
                                <div class="text-sm text-gray-600 pl-2">
                                    (<span id="youth-calc-numerator" class="font-medium"></span> ÷ <span id="youth-calc-denominator" class="font-medium"></span>) × 100 = 
                                    <span id="youth-ratio" class="font-bold text-blue-600 text-base"></span>
                                </div>
                            </li>
                            <li>
                                <strong>노년 부양비:</strong> 
                                <div class="text-sm text-gray-600 pl-2">
                                    (<span id="elderly-calc-numerator" class="font-medium"></span> ÷ <span id="elderly-calc-denominator" class="font-medium"></span>) × 100 = 
                                    <span id="elderly-ratio" class="font-bold text-red-600 text-base"></span>
                                </div>
                            </li>
                            <li class="border-t pt-3 mt-3">
                                <strong>총 부양비:</strong> 
                                 <div class="text-sm text-gray-600 pl-2">
                                    <span id="total-calc-youth-ratio" class="font-medium"></span> + <span id="total-calc-elderly-ratio" class="font-medium"></span> = 
                                    <span id="total-ratio" class="font-bold text-emerald-600 text-base"></span>
                                </div>
                            </li>
                        </ul>
                         <p class="text-xs text-slate-500 mt-4">*부양비 = (부양 인구 / 생산가능인구) × 100</p>
                    </div>
                </div>
            </div>
        </div>
    </section>
</main>

<!-- Footer Section -->
<footer class="bg-gray-900 text-white py-10 mt-16">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
        <p class="text-lg">&copy; 2025 허지현 학생 맞춤형 공략집</p>
        <p class="text-base text-gray-400 mt-2">만점을 진심으로 응원합니다!</p>
    </div>
</footer>

<script>
document.addEventListener('DOMContentLoaded', () => {
// 이 페이지에 차트 캔버스가 있을 때만 스크립트를 실행합니다.
if (document.getElementById('mobilityChart') && document.getElementById('populationChart')) {

    // --- 사회 이동표 차트 로직 ---
    const mobilityData = {
        labels: ['부모: 상', '부모: 중', '부모: 하'],
        datasets: [
            { label: '자녀: 상', data: [15, 5, 2], backgroundColor: 'rgba(52, 211, 153, 0.7)' },
            { label: '자녀: 중', data: [5, 30, 10], backgroundColor: 'rgba(59, 130, 246, 0.7)' },
            { label: '자녀: 하', data: [3, 8, 17], backgroundColor: 'rgba(239, 68, 68, 0.7)' }
        ]
    };
    const mobilityCtx = document.getElementById('mobilityChart').getContext('2d');
    const mobilityChart = new Chart(mobilityCtx, {
        type: 'bar',
        data: mobilityData,
        options: {
            responsive: true,
            maintainAspectRatio: false,
            scales: {
                x: { stacked: true },
                y: { stacked: true, beginAtZero: true, title: { display: true, text: '인원 (가상 수치)' } }
            },
            plugins: {
                title: { display: true, text: '세대 간 사회 이동 (부모 → 자녀)', font: { size: 16 } },
                tooltip: { mode: 'index' }
            }
        }
    });

    window.updateMobilityChart = (type) => {
        const explanationEl = document.getElementById('mobility-explanation');
        let explanationHTML = '';
        const baseColors = ['rgba(52, 211, 153, 0.7)', 'rgba(59, 130, 246, 0.7)', 'rgba(239, 68, 68, 0.7)'];
        const highlightColor = 'rgba(251, 191, 36, 1)';
        const mutedColor = 'rgba(200, 200, 200, 0.5)';

        mobilityChart.data.datasets.forEach((dataset, i) => {
            dataset.backgroundColor = dataset.data.map((_, j) => {
                if (type === 'all') return baseColors[i];
                if (type === 'inheritance' && i === j) return highlightColor;
                if (type === 'upward' && i < j) return highlightColor;
                if (type === 'downward' && i > j) return highlightColor;
                return mutedColor;
            });
        });
        mobilityChart.update();
        
        switch(type) {
            case 'all':
                explanationHTML = `<h4 class="font-semibold text-lg mb-2">전체 보기</h4><p class="text-slate-700">부모 세대의 계층이 자녀 세대에서 어떻게 분포되는지 전체적으로 보여줍니다. 총 100명의 데이터를 기반으로 분석합니다.</p>`;
                break;
            case 'inheritance':
                explanationHTML = `<h4 class="font-semibold text-lg mb-2">계층 대물림 (15+30+17 = 62명)</h4><p class="text-slate-700">부모와 자녀의 계층이 동일한 경우입니다. (상→상, 중→중, 하→하) 전체의 62%가 계층을 대물림했습니다.</p>`;
                break;
            case 'upward':
                explanationHTML = `<h4 class="font-semibold text-lg mb-2">상승 이동 (5+2+10 = 17명)</h4><p class="text-slate-700">자녀의 계층이 부모보다 높아진 경우입니다. (중→상, 하→상, 하→중) 세대 간 이동이 발생한 38명 중 약 45%가 상승 이동을 경험했습니다.</p>`;
                break;
            case 'downward':
                explanationHTML = `<h4 class="font-semibold text-lg mb-2">하강 이동 (5+3+8 = 16명)</h4><p class="text-slate-700">자녀의 계층이 부모보다 낮아진 경우입니다. (상→중, 상→하, 중→하) 하강 이동 비율은 전체의 16%입니다.</p>`;
                break;
        }
        explanationEl.innerHTML = explanationHTML;
    };
    updateMobilityChart('all');

    // --- 인구 구조 차트 로직 ---
    const populationRawData = [
        { year: 1990, youth: 25, working: 60, elderly: 5 },
        { year: 2020, youth: 15, working: 65, elderly: 20 },
        { year: 2050, youth: 10, working: 50, elderly: 40 },
    ];
    
    const populationData = {
        labels: ['유소년 인구(0-14세)', '생산가능인구(15-64세)', '노년 인구(65세 이상)'],
        datasets: [{
            label: '인구 비율 (%)',
            data: [25, 60, 5],
            backgroundColor: ['rgba(59, 130, 246, 0.7)', 'rgba(22, 163, 74, 0.7)', 'rgba(239, 68, 68, 0.7)']
        }]
    };

    const populationCtx = document.getElementById('populationChart').getContext('2d');
    const populationChart = new Chart(populationCtx, {
        type: 'doughnut',
        data: populationData,
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                title: { display: true, text: '1990년 인구 구조', font: { size: 16 } },
                legend: { position: 'top' }
            }
        }
    });
    
    const populationButtons = document.querySelectorAll('#killer-questions button[onclick^="updatePopulationData"]');
    window.updatePopulationData = (index) => {
        const data = populationRawData[index];
        populationChart.data.datasets[0].data = [data.youth, data.working, data.elderly];
        populationChart.options.plugins.title.text = `${data.year}년 인구 구조` + (data.year === 2050 ? ' (전망)' : '');
        populationChart.update();
        
        const youthRatio = ((data.youth / data.working) * 100).toFixed(1);
        const elderlyRatio = ((data.elderly / data.working) * 100).toFixed(1);
        const totalRatio = (parseFloat(youthRatio) + parseFloat(elderlyRatio)).toFixed(1);

        document.getElementById('population-explanation').querySelector('h4').textContent = `${data.year}년 인구 구조 분석` + (data.year === 2050 ? ' (전망)' : '');
        
        // Update calculation display
        document.getElementById('youth-calc-numerator').textContent = data.youth;
        document.getElementById('youth-calc-denominator').textContent = data.working;
        document.getElementById('youth-ratio').textContent = youthRatio;

        document.getElementById('elderly-calc-numerator').textContent = data.elderly;
        document.getElementById('elderly-calc-denominator').textContent = data.working;
        document.getElementById('elderly-ratio').textContent = elderlyRatio;

        document.getElementById('total-calc-youth-ratio').textContent = youthRatio;
        document.getElementById('total-calc-elderly-ratio').textContent = elderlyRatio;
        document.getElementById('total-ratio').textContent = totalRatio;

        populationButtons.forEach((btn, i) => {
            btn.classList.toggle('bg-emerald-500', i === index);
            btn.classList.toggle('text-white', i === index);
            btn.classList.toggle('bg-slate-200', i !== index);
            btn.classList.toggle('text-slate-800', i !== index);
            btn.classList.toggle('hover:bg-emerald-600', !btn.classList.contains('bg-emerald-500'));
            btn.classList.toggle('hover:bg-slate-300', btn.classList.contains('bg-slate-200'));
        });
    };
    updatePopulationData(0);
}
});
</script>

</body>
</html>

