<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>캡스톤2 진도 보고서 | 스마트 우산꽂이</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet">
    <!-- html2pdf.js 라이브러리 추가 -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js" xintegrity="sha512-GsLlZN/3F2ErC5ifS5QtgpiJtWd43JWSuIgh7mbzZ8zBALEAoU8C/VxcoVssWPGkP5vcwGS2LhG8oKxGiC/xjo==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    
    <!-- Application Structure Plan: 탭 기반 SPA 구조를 선택했습니다. 사용자가 '핵심 성과', '핵심 시나리오', '외관 조립', '향후 계획' 4개의 주요 주제를 빠르게 탐색할 수 있도록 설계했습니다. 이 구조는 선형적인 보고서 대신 성과 중심의 직관적인 탐색을 제공하며, 특히 '핵심 시나리오' 탭에서 GIF 시연을 통해 이번 주 가장 큰 성과인 End-to-End 통신을 시각적으로 강조합니다. -->
    <!-- Visualization & Content Choices: 
         - [시나리오 1,2,3] -> 시연 -> GIF 임베드 (HTML/CSS) -> '앱->H/W' 및 'H/W->앱'의 양방향 통신을 실제로 보여줌 -> 상호작용성 극대화.
         - [외관 조립] -> 정보 전달 -> 이미지 갤러리 (HTML/Tailwind Grid) -> '경첩 변경', '쿨러 부착' 등 팀의 물리적 진행 상황을 명확히 전달.
         - [향후 계획] -> 정보 전달 -> 스타일링된 목록 (HTML/CSS) -> 차주 계획을 가독성 높게 전달.
         - Chart.js는 본 보고서의 질적, 시연적 특성에 불필요하여 사용하지 않음. NO SVG/Mermaid. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body { font-family: 'Noto Sans KR', sans-serif; background-color: #f9fafb; }
        .tab-link { transition: all 0.2s ease-in-out; border-bottom: 3px solid transparent; }
        .tab-link.active { border-bottom-color: #2563eb; color: #2563eb; font-weight: 700; }
        .content-section { display: none; }
        .content-section.active { display: block; animation: fadeIn 0.5s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .gallery-item { border: 1px solid #e5e7eb; border-radius: 0.75rem; overflow: hidden; box-shadow: 0 1px 3px 0 rgba(0,0,0,0.05); }
        .gallery-item img { display: block; width: 100%; height: 240px; object-fit: cover; }
        .gallery-item figcaption { background-color: #f9fafb; padding: 12px 16px; font-size: 0.875rem; text-align: center; color: #374151; font-weight: 500;}
        .list-check { list-style-type: '✅ '; padding-left: 1.5rem; }
        .list-check li { margin-bottom: 0.5rem; padding-left: 0.5rem; }

        /* PDF 인쇄 시 탭 네비게이션 숨기기 (JavaScript로 제어하지만, 예비용) */
        @media print {
            .no-print { display: none; }
            .content-section { display: block !important; } /* 모든 섹션 강제 표시 */
        }
    </style>
</head>
<body class="text-gray-800">

    <!-- PDF 다운로드 버튼 컨테이너 -->
    <div class="max-w-5xl mx-auto px-4 md:px-8 pt-4 md:pt-8 flex justify-end no-print">
        <button id="download-pdf" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg shadow-md transition duration-200 ease-in-out">
            📄 PDF로 다운로드
        </button>
    </div>

    <!-- 인쇄될 리포트 컨텐츠 영역 -->
    <div id="report-content" class="max-w-5xl mx-auto p-4 md:p-8 pt-4 md:pt-4">
        
        <!-- 헤더 -->
        <header class="mb-8">
            <div class="bg-blue-600 text-white p-6 rounded-xl shadow-lg">
                <h1 class="text-3xl md:text-4xl font-bold">캡스톤 디자인 II - 진도 보고서</h1>
                <p class="text-xl mt-2 opacity-90">스마트 우산꽂이 시스템</p>
                <p class="text-sm mt-4 opacity-80">작성자: 손윤재 (앱/서버 ↔ 하드웨어 연동 담당)</p>
            </div>
        </header>

        <!-- 탭 네비게이션 (no-print 클래스 추가) -->
        <nav class="flex space-x-4 md:space-x-8 border-b-2 border-gray-200 mb-8 no-print">
            <button class="tab-link active py-3 px-1 text-base md:text-lg" data-target="overview">핵심 성과</button>
            <button class="tab-link py-3 px-1 text-base md:text-lg" data-target="scenarios">핵심 시나리오</button>
            <button class="tab-link py-3 px-1 text-base md:text-lg" data-target="assembly">외관 조립</button>
            <button class="tab-link py-3 px-1 text-base md:text-lg" data-target="schedule">향후 계획</button>
        </nav>

        <!-- 컨텐츠 섹션 -->
        <main>
            <!-- 1. 핵심 성과 -->
            <section id="overview" class="content-section active">
                <h2 class="text-2xl font-bold mb-6">금주 핵심 성과: 시스템 전체 연동</h2>
                <p class="text-lg text-gray-700 mb-6">
                    지난주까지 개별 테스트했던 S/W(앱 ↔ 서버)와 H/W(라즈베리파이 ↔ 부품) 두 파트를 성공적으로 통합했습니다. 금주의 핵심 성과는 앱, 서버, 라즈베리파이, 부품 간의 End-to-End 양방향 통신을 완벽하게 구현한 것입니다.
                </p>
                <div class="grid md:grid-cols-2 gap-6">
                    <div class="bg-white p-6 rounded-lg shadow-md border border-gray-100">
                        <h3 class="text-xl font-bold mb-3 text-blue-600">S/W → H/W (원격 제어)</h3>
                        <p class="text-gray-700">클라이언트(앱)에서 발생한 이벤트가 클라우드 서버를 거쳐 물리적 디바이스(라즈베리파이)를 성공적으로 제어함을 확인했습니다.</p>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-md border border-gray-100">
                        <h3 class="text-xl font-bold mb-3 text-blue-600">H/W → S/W (모니터링)</h3>
                        <p class="text-gray-700">디바이스(센서)의 상태 값이 서버를 거쳐 앱 UI에 실시간으로 반영되는 전체 데이터 흐름의 검증을 완료했습니다.</p>
                    </div>
                </div>
            </section>

            <!-- 2. 핵심 시나리오 -->
            <section id="scenarios" class="content-section">
                <h2 class="text-2xl font-bold mb-6">핵심 시나리오 테스트 (시연)</h2>
                <p class="text-gray-600 mb-6">설계된 주요 시나리오 3가지가 모두 정상 작동함을 시각 자료(GIF)로 확인했습니다.</p>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <figure class="gallery-item">
                        <img src="https://i.postimg.cc/WFWjzWbW/sinaliodongyeongsang1.gif" alt="시나리오 1: 문 닫힘 감지">
                        <figcaption class="h-20 flex items-center justify-center">시나리오 1: H/W (문 닫힘) → 앱 UI 변경</figcaption>
                    </figure>
                    <figure class="gallery-item">
                        <img src="https://i.postimg.cc/ft2Zy2Tr/sinaliodongyeongsang2.gif" alt="시나리오 2: 앱에서 LED 제어">
                        <figcaption class="h-20 flex items-center justify-center">시나리오 2: 앱 → H/W (LED 원격 제어)</figcaption>
                    </figure>
                    <figure class="gallery-item">
                        <img src="https://i.postimg.cc/gLxpZVxb/sinaliodongyeongsang3.gif" alt="시나리오 3: 수위 센서 감지">
                        <figcaption class="h-20 flex items-center justify-center">시나리오 3: H/W (수위 감지) → 기능 강제 종료</figcaption>
                    </figure>
                </div>
            </section>

            <!-- 3. 외관 조립 -->
            <section id="assembly" class="content-section">
                <h2 class="text-2xl font-bold mb-6">하드웨어 외관 조립 (팀 전체)</h2>
                <p class="text-gray-600 mb-6">시스템 연동과 병행하여, 하드웨어 외관 조립 및 개선 작업을 진행했습니다. 경첩 위치를 내부로 변경하고 주요 부품을 외관에 부착했습니다.</p>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <figure class="gallery-item">
                        <img src="https://i.postimg.cc/sQ6yx6DJ/oegwan-gyeongcheob-naebulo-byeongyeong.jpg" alt="경첩 위치 변경">
                        <figcaption>경첩을 내부로 이동하여 심미성 향상</figcaption>
                    </figure>
                    <figure class="gallery-item">
                        <img src="https://i.postimg.cc/N9JYFJfX/oegwan-kulleo-sajin.jpg" alt="쿨러 부착">
                        <figcaption>우산꽂이 통 내부에 쿨러 부착</figcaption>
                    </figure>
                    <figure class="gallery-item">
                        <img src="https://i.postimg.cc/YLv7W6hD/oegwan3.jpg" alt="LCD 및 라즈베리파이 부착">
                        <figcaption>외관 제어부에 LCD 및 Pi 부착</figcaption>
                    </figure>
                </div>
            </section>

            <!-- 4. 향후 계획 -->
            <section id="schedule" class="content-section">
                <h2 class="text-2xl font-bold mb-6">차주 계획 </h2>
                <p class="text-gray-600 mb-6">금주 시스템 연동 테스트가 성공함에 따라, 차주는 완성된 하드웨어 외관에 모든 전자 부품을 통합하고 최종 시나리오를 검증하는 단계로 진입합니다.</p>
                <div class="bg-white p-6 rounded-lg shadow-md border border-gray-100">
                    <ul class="list-check space-y-4 text-gray-700">
                        <li>
                            <strong class="text-gray-800">하드웨어 최종 조립 (물리적 통합)</strong>
                            <p class="text-sm ml-6 text-gray-600">테스트가 완료된 모든 전자 부품(PCB, 센서, 라즈베리파이 등)을 실제 외관 내부에 견고하게 장착하고 배선을 정리합니다.</p>
                        </li>
                        <li>
                            <strong class="text-gray-800">물받이통 제작 (기능 보완)</strong>
                            <p class="text-sm ml-6 text-gray-600">아크릴 판을 재단/접착하여 내부 누수 방지용 물받이통을 제작하고, 방수 기능을 검증한 뒤 하단에 설치합니다.</p>
                        </li>
                        <li>
                            <strong class="text-red-600 font-bold">[핵심] 최종 통합 시나리오 테스트 (End-to-End 검증)</strong>
                            <p class="text-sm ml-6 text-gray-600">"앱에서 30분 건조 설정 → 문 닫힘 감지 → 쿨러/UV 자동 작동 → 수위 감지 시 자동 중단 → 앱에 경고 표시"와 같은 복합 시나리오의 안정성을 집중 검증합니다.</p>
                        </li>
                    </ul>
                </div>
            </section>
        </main>
    </div>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        const tabs = document.querySelectorAll('.tab-link');
        const sections = document.querySelectorAll('.content-section');
        const downloadBtn = document.getElementById('download-pdf');

        // --- 탭 기능 로직 ---
        tabs.forEach(tab => {
            tab.addEventListener('click', (e) => {
                e.preventDefault();
                const targetId = tab.getAttribute('data-target');

                // 탭 활성화 상태 변경
                tabs.forEach(t => t.classList.remove('active'));
                tab.classList.add('active');

                // 컨텐츠 섹션 표시 변경
                sections.forEach(s => {
                    if (s.id === targetId) {
                        s.classList.add('active');
                    } else {
                        s.classList.remove('active');
                    }
                });
            });
        });

        // 초기 로드 시 'overview' 활성화 (HTML에 이미 active가 있지만, JS로도 제어)
        // document.querySelector('.tab-link[data-target="overview"]').click();
        // -> HTML에 active가 이미 있으므로 JS 클릭은 불필요.

        // --- PDF 다운로드 로직 ---
        downloadBtn.addEventListener('click', () => {
            // 1. 인쇄할 요소 가져오기
            const element = document.getElementById('report-content');

            // 2. 페이지와 상호작용 없이 인쇄하기 위해 요소 복제
            const elementClone = element.cloneNode(true);

            // 3. 복제본에서 모든 컨텐츠 섹션을 찾음
            const sectionsInClone = elementClone.querySelectorAll('.content-section');
            
            // 4. PDF에는 모든 섹션이 보이도록 스타일 변경
            sectionsInClone.forEach(section => {
                section.style.display = 'block'; // 'none'이었던 탭들도 모두 'block'으로
                section.classList.remove('active'); // active 스타일 제거
                section.style.animation = 'none'; // fadeIn 애니메이션 제거
            });

            // 5. PDF에는 탭 네비게이션이 필요 없으므로 숨김
            const navInClone = elementClone.querySelector('nav');
            if (navInClone) {
                navInClone.style.display = 'none';
            }

            // 6. html2pdf 옵션 설정
            const opt = {
                margin:       [0.8, 0.5, 0.8, 0.5], // [top, left, bottom, right] in inches
                filename:     '캡스톤_13주차_진도보고서_스마트우산꽂이.pdf',
                image:        { type: 'jpeg', quality: 0.98 },
                html2canvas:  { 
                    scale: 2, // 퀄리티 향상
                    useCORS: true, // 외부 이미지(postimg.cc) 로드를 위해 필수
                    letterRendering: true 
                },
                jsPDF:        { unit: 'in', format: 'a4', orientation: 'portrait' },
                pagebreak:    { mode: ['avoid-all', 'css', 'legacy'] } // 페이지 나뉨 방지
            };

            // 7. 수정된 복제본을 기반으로 PDF 생성 및 저장
            // (참고: GIF는 PDF에서 첫 프레임만 고정된 이미지로 표시됩니다.)
            html2pdf().from(elementClone).set(opt).save();
        });
    });
</script>

</body>
</html>
