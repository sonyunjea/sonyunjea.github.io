<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>k-NN ëŒ€í™”í˜• ì‹œë®¬ë ˆì´í„°</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Chosen Palette: Serene Sage -->
    <!-- Application Structure Plan: ì‚¬ìš©ìê°€ k-NN ì•Œê³ ë¦¬ì¦˜ì˜ í•µì‹¬ ì›ë¦¬ë¥¼ ì§ì ‘ ì²´í—˜í•˜ê³  ì´í•´í•  ìˆ˜ ìˆë„ë¡ 'ì œì–´ íŒ¨ë„'ê³¼ 'ì‹œê°í™”' ì˜ì—­ìœ¼ë¡œ êµ¬ì„±ëœ 2ë‹¨ ëŒ€ì‹œë³´ë“œ êµ¬ì¡°ë¥¼ ì„¤ê³„í–ˆìŠµë‹ˆë‹¤. ì™¼ìª½ ì œì–´ íŒ¨ë„ì—ì„œëŠ” ì•Œê³ ë¦¬ì¦˜ì˜ í•µì‹¬ íŒŒë¼ë¯¸í„°ì¸ 'k'ê°’ì„ ìŠ¬ë¼ì´ë”ë¡œ ì¡°ì ˆí•˜ê³ , ë°ì´í„° í¬ì¸íŠ¸ë¥¼ ì¬ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì˜¤ë¥¸ìª½ ì‹œê°í™” ì˜ì—­ì—ì„œëŠ” Chart.jsë¥¼ ì´ìš©í•´ ë°ì´í„° ë¶„í¬ì™€ ì˜ˆì¸¡ ê³¼ì •ì„ ì‹¤ì‹œê°„ìœ¼ë¡œ ë³´ì—¬ì¤ë‹ˆë‹¤. íŠ¹íˆ, ì°¨íŠ¸ë¥¼ ì§ì ‘ í´ë¦­í•˜ì—¬ ìƒˆë¡œìš´ ë°ì´í„°ì˜ ìœ„ì¹˜ë¥¼ ì§€ì •í•˜ë©´ ì¦‰ì‹œ ì˜ˆì¸¡ ê²°ê³¼ê°€ ì—…ë°ì´íŠ¸ë˜ë„ë¡ í•˜ì—¬, ì‚¬ìš©ìì˜ ìƒí˜¸ì‘ìš©ì„ ê·¹ëŒ€í™”í–ˆìŠµë‹ˆë‹¤. ì´ëŸ¬í•œ êµ¬ì¡°ëŠ” ì •ì ì¸ ì„¤ëª…ë³´ë‹¤ í›¨ì”¬ ê¹Šì€ í•™ìŠµ ê²½í—˜ì„ ì œê³µí•˜ë©°, íŒŒë¼ë¯¸í„° ë³€í™”ì— ë”°ë¥¸ ê²°ê³¼ì˜ ë¯¼ê°ë„ë¥¼ ì§ê´€ì ìœ¼ë¡œ íƒìƒ‰í•˜ê²Œ í•´ì¤ë‹ˆë‹¤. -->
    <!-- Visualization & Content Choices: 
        1. ë°ì´í„° ë¶„í¬ ë° ì˜ˆì¸¡ ê³¼ì • ì‹œê°í™” -> ëª©í‘œ: ë°ì´í„° í´ëŸ¬ìŠ¤í„°, ìƒˆë¡œìš´ ë°ì´í„°, ìµœê·¼ì ‘ ì´ì›ƒì˜ ê´€ê³„ë¥¼ ëª…í™•íˆ ë³´ì—¬ì£¼ê¸° -> ì‹œê°í™” ë°©ì‹: Chart.jsë¥¼ ì´ìš©í•œ ìº”ë²„ìŠ¤ ê¸°ë°˜ ì‚°ì ë„(Scatter Plot) -> ìƒí˜¸ì‘ìš©: ì°¨íŠ¸ í´ë¦­ ì‹œ ìƒˆë¡œìš´ ë°ì´í„° ìœ„ì¹˜ ë³€ê²½, 'k'ê°’ ë³€ê²½ ì‹œ ê°•ì¡°ë˜ëŠ” ì´ì›ƒ(neighbor) ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸ -> ì •ë‹¹ì„±: ì‚°ì ë„ëŠ” 2D ë°ì´í„°ì˜ ê³µê°„ì  ë¶„í¬ì™€ ì ë“¤ ê°„ì˜ ê±°ë¦¬ë¥¼ í‘œí˜„í•˜ëŠ” ë° ê°€ì¥ ì§ê´€ì ì´ë©°, ë™ì ìœ¼ë¡œ ì ì˜ ìŠ¤íƒ€ì¼(ìƒ‰ìƒ, í¬ê¸°)ì„ ë³€ê²½í•˜ì—¬ k-NNì˜ í•µì‹¬ì¸ 'ì´ì›ƒ' ê°œë…ì„ íš¨ê³¼ì ìœ¼ë¡œ ê°•ì¡°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
        2. 'k' ê°’ ì œì–´ -> ëª©í‘œ: kê°’ì˜ ë³€í™”ê°€ ì˜ˆì¸¡ ê²°ê³¼ì— ë¯¸ì¹˜ëŠ” ì˜í–¥ì„ ì‚¬ìš©ìê°€ ì§ì ‘ íƒìƒ‰í•˜ê²Œ í•˜ê¸° -> í‘œí˜„ ë°©ì‹: HTML ìŠ¬ë¼ì´ë” ì…ë ¥(<input type="range">) ë° í…ìŠ¤íŠ¸ ë””ìŠ¤í”Œë ˆì´ -> ìƒí˜¸ì‘ìš©: ìŠ¬ë¼ì´ë”ë¥¼ ì›€ì§ì´ë©´ ì‹¤ì‹œê°„ìœ¼ë¡œ kê°’ì´ ë³€ê²½ë˜ê³ , ì¦‰ì‹œ ì˜ˆì¸¡ ì•Œê³ ë¦¬ì¦˜ì´ ì¬ì‹¤í–‰ë˜ì–´ ì‹œê°í™” ë° ê²°ê³¼ í…ìŠ¤íŠ¸ê°€ ì—…ë°ì´íŠ¸ë¨ -> ì •ë‹¹ì„±: ìŠ¬ë¼ì´ë”ëŠ” íŠ¹ì • ë²”ìœ„ ë‚´ì˜ ìˆ«ìë¥¼ ì„ íƒí•˜ëŠ” ë° ê°€ì¥ ì§ê´€ì ì¸ UIì´ë©°, ì¦‰ê°ì ì¸ í”¼ë“œë°±ì€ ì›ì¸(kê°’)ê³¼ ê²°ê³¼(ì˜ˆì¸¡)ì˜ ê´€ê³„ë¥¼ ì‚¬ìš©ìê°€ ëŠ¥ë™ì ìœ¼ë¡œ í•™ìŠµí•˜ê²Œ ë§Œë“­ë‹ˆë‹¤. 
        3. ê²°ê³¼ í…ìŠ¤íŠ¸ -> ëª©í‘œ: ì˜ˆì¸¡ ê²°ê³¼ì™€ ê·¸ ê·¼ê±°ë¥¼ ëª…í™•í•˜ê²Œ í…ìŠ¤íŠ¸ë¡œ ì „ë‹¬ -> í‘œí˜„ ë°©ì‹: ë™ì ìœ¼ë¡œ ì—…ë°ì´íŠ¸ë˜ëŠ” HTML í…ìŠ¤íŠ¸ ë¸”ë¡ -> ìƒí˜¸ì‘ìš©: ì˜ˆì¸¡ì´ ë³€ê²½ë  ë•Œë§ˆë‹¤ JavaScriptê°€ í•´ë‹¹ DOM ìš”ì†Œì˜ ë‚´ìš©ì„ ì¦‰ì‹œ ê°±ì‹  -> ì •ë‹¹ì„±: ì‹œê°ì  í‘œí˜„ë§Œìœ¼ë¡œëŠ” ë¶€ì¡±í•  ìˆ˜ ìˆëŠ” êµ¬ì²´ì ì¸ ì •ë³´(ì˜ˆ: '5ê°œ ì´ì›ƒì˜ ê·¸ë£¹: [2, 2, 1, 2, 2]', 'ìµœì¢… ì˜ˆì¸¡: 2ë²ˆ ê·¸ë£¹')ë¥¼ ëª…ì‹œì ìœ¼ë¡œ ì „ë‹¬í•˜ì—¬ í•™ìŠµ íš¨ê³¼ë¥¼ ê·¹ëŒ€í™”í•©ë‹ˆë‹¤.
        -> Library/Method: Chart.js (Canvas), Vanilla JS, Tailwind CSS. SVG/Mermaid JSëŠ” ì‚¬ìš©í•˜ì§€ ì•ŠìŒ. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body { font-family: 'Pretendard', sans-serif; background-color: #f8f9fa; }
        .card { background-color: white; border-radius: 0.75rem; box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1); padding: 1.5rem; }
        .btn { transition: all 0.2s ease-in-out; }
        .btn:hover { transform: translateY(-2px); box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1); }
        .slider-thumb::-webkit-slider-thumb { -webkit-appearance: none; appearance: none; width: 20px; height: 20px; background: #3b82f6; border-radius: 50%; cursor: pointer; }
        .slider-thumb::-moz-range-thumb { width: 20px; height: 20px; background: #3b82f6; border-radius: 50%; cursor: pointer; }
    </style>
</head>
<body class="text-gray-800 p-4 lg:p-8">
    <div class="max-w-7xl mx-auto">
        <header class="text-center mb-8">
            <h1 class="text-3xl md:text-4xl font-bold text-gray-900">k-ìµœê·¼ì ‘ ì´ì›ƒ(k-NN) ëŒ€í™”í˜• ì‹œë®¬ë ˆì´í„°</h1>
            <p class="mt-2 text-lg text-gray-600">ì•Œê³ ë¦¬ì¦˜ì˜ í•µì‹¬ ì›ë¦¬ë¥¼ ì§ì ‘ ì²´í—˜í•˜ë©° ì´í•´í•´ë³´ì„¸ìš”.</p>
        </header>

        <main class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            <aside class="lg:col-span-1 space-y-6">
                <div class="card">
                    <h2 class="text-xl font-bold mb-4 border-b pb-2">ğŸ¤” k-NNì´ë€?</h2>
                    <p class="text-gray-600">
                        ìƒˆë¡œìš´ ë°ì´í„°ì˜ ì†Œì†ì„ ì˜ˆì¸¡í•  ë•Œ, ê·¸ ë°ì´í„°ì™€ ê°€ì¥ ê°€ê¹Œìš´ 'k'ê°œì˜ ì´ì›ƒ ë°ì´í„°ë¥¼ ë³´ê³  ë‹¤ìˆ˜ê²°ë¡œ ì†Œì† ê·¸ë£¹ì„ ê²°ì •í•˜ëŠ” ê°„ë‹¨í•˜ë©´ì„œë„ ê°•ë ¥í•œ ë¨¸ì‹ ëŸ¬ë‹ ì•Œê³ ë¦¬ì¦˜ì…ë‹ˆë‹¤.
                    </p>
                </div>
                
                <div class="card">
                    <h2 class="text-xl font-bold mb-4 border-b pb-2">âš™ï¸ ì œì–´ íŒ¨ë„</h2>
                    <div class="space-y-4">
                        <div>
                            <label for="k-slider" class="font-semibold">ì´ì›ƒ ìˆ˜ (k): <span id="k-value" class="font-bold text-blue-600">5</span></label>
                            <input id="k-slider" type="range" min="1" max="15" value="5" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer slider-thumb mt-2">
                        </div>
                        <button id="regenerate-btn" class="w-full bg-blue-600 text-white font-bold py-2 px-4 rounded-lg btn">
                            ğŸ”„ ë°ì´í„° ì¬ìƒì„±
                        </button>
                    </div>
                </div>

                <div class="card">
                    <h2 class="text-xl font-bold mb-4 border-b pb-2">ğŸ“Š ì˜ˆì¸¡ ê²°ê³¼</h2>
                    <div class="space-y-3 text-gray-700">
                        <p>ğŸ“ ìƒˆë¡œìš´ ë°ì´í„° ì¢Œí‘œ: <strong id="new-point-coords" class="text-gray-900">(6.0, 5.0)</strong></p>
                        <p>ğŸ‘¥ ì„ íƒëœ ì´ì›ƒ ê·¸ë£¹: <strong id="neighbor-labels" class="text-gray-900">ê³„ì‚° ì¤‘...</strong></p>
                        <p class="text-lg">âœ… ìµœì¢… ì˜ˆì¸¡ ê·¸ë£¹: <strong id="prediction-result" class="text-blue-700 text-xl">ê³„ì‚° ì¤‘...</strong></p>
                    </div>
                </div>
            </aside>

            <section class="lg:col-span-2 card">
                <p class="text-center text-gray-500 mb-4">ì°¨íŠ¸ì˜ ì•„ë¬´ ê³³ì´ë‚˜ í´ë¦­í•˜ì—¬ ìƒˆë¡œìš´ ë°ì´í„°(â­)ì˜ ìœ„ì¹˜ë¥¼ ì˜®ê²¨ë³´ì„¸ìš”.</p>
                <div class="chart-container w-full h-[400px] md:h-[500px] lg:h-full max-h-[600px] relative mx-auto">
                    <canvas id="knn-chart"></canvas>
                </div>
            </section>
        </main>
    </div>

    <script>
        const kSlider = document.getElementById('k-slider');
        const kValueSpan = document.getElementById('k-value');
        const regenerateBtn = document.getElementById('regenerate-btn');
        const newPointCoordsSpan = document.getElementById('new-point-coords');
        const neighborLabelsSpan = document.getElementById('neighbor-labels');
        const predictionResultSpan = document.getElementById('prediction-result');
        const chartCanvas = document.getElementById('knn-chart');

        let originalData = [];
        let labels = [];
        let newDataPoint = { x: 6, y: 5 };
        let k = 5;
        let knnChart;

        const COLORS = {
            group1: 'rgba(255, 99, 132, 0.8)',
            group2: 'rgba(54, 162, 235, 0.8)',
            group3: 'rgba(255, 206, 86, 0.8)',
            newPoint: 'rgba(255, 0, 0, 1)',
            neighbor: 'rgba(75, 192, 192, 1)',
            neighborHighlight: 'rgba(75, 192, 192, 0.3)',
        };

        function generateRandomData() {
            originalData = [];
            labels = [];

            const centers = [ { x: 2, y: 2 }, { x: 8, y: 8 }, { x: 9, y: 2 }];
            const pointsPerCluster = 15;

            centers.forEach((center, i) => {
                for (let j = 0; j < pointsPerCluster; j++) {
                    const x = center.x + (Math.random() - 0.5) * 4;
                    const y = center.y + (Math.random() - 0.5) * 4;
                    originalData.push({ x, y });
                    labels.push(i + 1);
                }
            });
        }

        function euclideanDistance(p1, p2) {
            return Math.sqrt(Math.pow(p1.x - p2.x, 2) + Math.pow(p1.y - p2.y, 2));
        }

        function predictKNN() {
            const distances = originalData.map((point, index) => ({
                dist: euclideanDistance(newDataPoint, point),
                label: labels[index],
                index: index
            }));

            distances.sort((a, b) => a.dist - b.dist);

            const neighbors = distances.slice(0, k);
            const neighborLabels = neighbors.map(n => n.label);

            if (neighborLabels.length === 0) {
                predictionResultSpan.textContent = "N/A";
                neighborLabelsSpan.textContent = "N/A";
                return { prediction: null, neighbors: [] };
            }

            const voteCounts = neighborLabels.reduce((acc, label) => {
                acc[label] = (acc[label] || 0) + 1;
                return acc;
            }, {});

            const prediction = Object.keys(voteCounts).reduce((a, b) => voteCounts[a] > voteCounts[b] ? a : b);
            
            updateResultsText(prediction, neighborLabels);
            return { prediction: parseInt(prediction), neighbors: neighbors.map(n => n.index) };
        }
        
        function updateResultsText(prediction, neighborLabels) {
            newPointCoordsSpan.textContent = `(${newDataPoint.x.toFixed(1)}, ${newDataPoint.y.toFixed(1)})`;
            neighborLabelsSpan.textContent = `[${neighborLabels.join(', ')}]`;
            predictionResultSpan.textContent = `${prediction}ë²ˆ ê·¸ë£¹`;
        }

        function createChart() {
            const ctx = chartCanvas.getContext('2d');
            knnChart = new Chart(ctx, {
                type: 'scatter',
                data: { datasets: [] },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: { beginAtZero: false, min: -2, max: 14 },
                        y: { beginAtZero: false, min: -2, max: 12 }
                    },
                    plugins: {
                        legend: { display: true, position: 'top' },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    let label = context.dataset.label || '';
                                    if (label) { label += ': '; }
                                    if (context.parsed.x !== null) {
                                        label += `(${(context.parsed.x).toFixed(1)}, ${(context.parsed.y).toFixed(1)})`;
                                    }
                                    return label;
                                }
                            }
                        }
                    },
                    onClick: handleChartClick,
                }
            });
        }
        
        function updateChart() {
            if (!knnChart) return;
            
            const { prediction, neighbors } = predictKNN();

            const datasets = [
                {
                    label: 'ê·¸ë£¹ 1',
                    data: originalData.filter((_, i) => labels[i] === 1),
                    backgroundColor: COLORS.group1,
                    pointRadius: 5,
                },
                {
                    label: 'ê·¸ë£¹ 2',
                    data: originalData.filter((_, i) => labels[i] === 2),
                    backgroundColor: COLORS.group2,
                    pointRadius: 5,
                },
                {
                    label: 'ê·¸ë£¹ 3',
                    data: originalData.filter((_, i) => labels[i] === 3),
                    backgroundColor: COLORS.group3,
                    pointRadius: 5,
                },
                {
                    label: 'ìƒˆë¡œìš´ ë°ì´í„°',
                    data: [newDataPoint],
                    backgroundColor: COLORS.newPoint,
                    pointStyle: 'star',
                    radius: 15,
                    borderColor: 'black',
                    borderWidth: 2,
                }
            ];
            
            if(neighbors.length > 0) {
                const neighborPoints = neighbors.map(i => originalData[i]);
                datasets.push({
                    label: 'ìµœê·¼ì ‘ ì´ì›ƒ',
                    data: neighborPoints,
                    backgroundColor: 'transparent',
                    borderColor: COLORS.neighbor,
                    borderWidth: 3,
                    pointRadius: 10,
                });
            }

            knnChart.data.datasets = datasets;
            knnChart.update();
        }

        function handleChartClick(evt) {
            const rect = chartCanvas.getBoundingClientRect();
            const x = knnChart.scales.x.getValueForPixel(evt.clientX - rect.left);
            const y = knnChart.scales.y.getValueForPixel(evt.clientY - rect.top);
            newDataPoint = { x, y };
            updateChart();
        }

        kSlider.addEventListener('input', (e) => {
            k = parseInt(e.target.value);
            kValueSpan.textContent = k;
            updateChart();
        });

        regenerateBtn.addEventListener('click', () => {
            generateRandomData();
            updateChart();
        });
        
        // Initial setup
        createChart();
        generateRandomData();
        updateChart();
    </script>
</body>
</html>
